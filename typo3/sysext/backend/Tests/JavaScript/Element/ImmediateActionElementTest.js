/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a);var c=Object.getOwnPropertyDescriptor(t,a);c&&!("get"in c?!t.__esModule:c.writable||c.configurable)||(c={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,n,c)}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return __setModuleDefault(t,e),t};define(["require","exports","TYPO3/CMS/Backend/Element/ImmediateActionElement","TYPO3/CMS/Backend/ModuleMenu","TYPO3/CMS/Backend/Viewport"],(function(e,t,a,n,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),describe("TYPO3/CMS/Backend/Element/ImmediateActionElement:",()=>{let t;beforeEach(()=>{t=document.createElement("div"),document.body.appendChild(t)}),afterEach(()=>{t.remove(),t=null}),it("dispatches action when created via constructor",async()=>{const n=c.Topbar.refresh,r={callback:()=>{}};spyOn(r,"callback").and.callThrough(),c.Topbar.refresh=r.callback;const o=new a.ImmediateActionElement;o.setAttribute("action","TYPO3.Backend.Topbar.refresh"),expect(r.callback).not.toHaveBeenCalled(),t.appendChild(o),await new Promise((t,a)=>{e(["TYPO3/CMS/Backend/Viewport"],t,a)}).then(__importStar),expect(r.callback).toHaveBeenCalled(),c.Topbar.refresh=n}),it("dispatches action when created via createElement",async()=>{const a=c.Topbar.refresh,n={callback:()=>{}};spyOn(n,"callback").and.callThrough(),c.Topbar.refresh=n.callback;const r=document.createElement("typo3-immediate-action");r.setAttribute("action","TYPO3.Backend.Topbar.refresh"),expect(n.callback).not.toHaveBeenCalled(),t.appendChild(r),await new Promise((t,a)=>{e(["TYPO3/CMS/Backend/Viewport"],t,a)}).then(__importStar),expect(n.callback).toHaveBeenCalled(),c.Topbar.refresh=a}),it("dispatches action when created from string",async()=>{const a=n.App.refreshMenu,c={callback:()=>{}};spyOn(c,"callback").and.callThrough(),n.App.refreshMenu=c.callback;const r=document.createRange().createContextualFragment('<typo3-immediate-action action="TYPO3.ModuleMenu.App.refreshMenu"></typo3-immediate-action>').querySelector("typo3-immediate-action");expect(c.callback).not.toHaveBeenCalled(),t.appendChild(r),await new Promise((t,a)=>{e(["TYPO3/CMS/Backend/ModuleMenu"],t,a)}).then(__importStar),expect(c.callback).toHaveBeenCalled(),n.App.refreshMenu=a}),it("dispatches action when created via innerHTML",async()=>{const a=n.App.refreshMenu,c={callback:()=>{}};spyOn(c,"callback").and.callThrough(),n.App.refreshMenu=c.callback,t.innerHTML='<typo3-immediate-action action="TYPO3.ModuleMenu.App.refreshMenu"></typo3-immediate-action>',await new Promise((t,a)=>{e(["TYPO3/CMS/Backend/ModuleMenu"],t,a)}).then(__importStar),expect(c.callback).toHaveBeenCalled(),n.App.refreshMenu=a})})}));