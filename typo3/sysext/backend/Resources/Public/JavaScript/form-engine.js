/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
import M from"@typo3/core/document-service.js";import c from"jquery";import N from"@typo3/backend/form-engine-validation.js";import m from"@typo3/backend/modal.js";import*as L from"@typo3/backend/utility/message-utility.js";import v from"@typo3/backend/severity.js";import*as Y from"@typo3/backend/backend-exception.js";import x from"@typo3/backend/event/interaction-request-map.js";import F from"@typo3/backend/utility.js";import{selector as f}from"@typo3/core/literals.js";import"@typo3/backend/form-engine/element/extra/char-counter.js";import k,{ModifierKeys as A}from"@typo3/backend/hotkeys.js";import h from"@typo3/core/event/regular-event.js";var D=function(){function T(t,n){n?e.interactionRequestMap.resolveFor(t):e.interactionRequestMap.rejectFor(t)}const y=new Map;y.set("typo3-backend-form-update-value",t=>{const n=document.querySelector(f`[name="${t.elementName}"]`),o=document.querySelector(f`[data-formengine-input-name="${t.elementName}"]`);e.Validation.updateInputField(t.elementName),n!==null&&(e.markFieldAsChanged(n),e.Validation.validateField(n)),o!==null&&o!==n&&e.Validation.validateField(o)}),y.set("typo3-backend-form-reload",t=>{const n=()=>{e.Validation.suspend(),e.saveDocument(),e.Validation.resume()};if(!t.confirmation){n();return}const o=m.advanced({title:TYPO3.lang["FormEngine.refreshRequiredTitle"],content:TYPO3.lang["FormEngine.refreshRequiredContent"],severity:v.warning,staticBackdrop:!0,buttons:[{text:TYPO3.lang["button.cancel"]||"Cancel",active:!0,btnClass:"btn-default",name:"cancel",trigger:()=>{o.hideModal()}},{text:TYPO3.lang["button.ok"]||"OK",btnClass:"btn-"+v.getCssClass(v.warning),name:"ok",trigger:()=>{e.closeModalsRecursive(),n()}}]})}),y.set("typo3-backend-form-update-bitmask",(t,n)=>{const o=n.target,a=e.formElement[t.elementName],i=o.checked!==t.invert,r=Math.pow(2,t.position),s=Math.pow(2,t.total)-r-1;a.value=i?a.value|r:a.value&s,a.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))});let P=!1,_=null;const e={consumeTypes:["typo3.setUrl","typo3.beforeSetUrl","typo3.refresh"],Validation:N,interactionRequestMap:x,formName:TYPO3.settings.FormEngine.formName,formElement:void 0,openedPopupWindow:null,browserUrl:"",doSaveFieldName:""};return Object.defineProperty(e,"formElement",{get:()=>document.forms.namedItem(e.formName),enumerable:!0,configurable:!1}),e.ready=async function(){return _??(_=async function(){P||await new Promise(n=>e.formElement.addEventListener("typo3:form-engine:ready",()=>n(),{once:!0}))}())},e.openPopupWindow=function(t,n,o){const a={mode:t,bparams:n};return o&&(t==="db"?a.expandPage=o:a.expandFolder=o),m.advanced({type:m.types.iframe,content:e.browserUrl+"&"+new URLSearchParams(a).toString(),size:m.sizes.large})},e.setSelectOptionFromExternalSource=function(t,n,o,a,i=[],r=void 0){let s,l,d=!1,g=!1;l=e.getFieldElement(t),s=l.get(0);const u=l.get(0);if(u===null||n==="--div--"||u instanceof HTMLOptGroupElement)return;const E=e.getFieldElement(t,"_list",!0);if(E.length>0&&(l=E,s=l.get(0),d=l.prop("multiple")&&l.prop("size")!="1",g=!0),d||g){const b=e.getFieldElement(t,"_avail"),C=b.get(0);if(!d){for(const p of s.querySelectorAll("option")){const w=b.find(f`option[value="${c(p).attr("value")}"]`);w.length&&(w.removeClass("hidden").prop("disabled",!1),e.enableOptGroup(w.get(0)))}l.empty()}if(i.length>0){let p=!1;(i.includes(n)||l.find("option").length==1&&i.includes(l.find("option").prop("value")))&&(l.empty(),p=!0),p&&typeof r<"u"&&r.closest("select").querySelectorAll("[disabled]").forEach(function(w){w.classList.remove("hidden"),w.disabled=!1,e.enableOptGroup(w)})}let S=!0;const O=e.getFieldElement(t,"_mul",!0);if(O.length==0||O.val()==0){for(const p of s.querySelectorAll("option"))if(p.value==n){S=!1;break}if(S&&typeof r<"u"){r.classList.add("hidden"),r.disabled=!0;const p=r.parentElement;p instanceof HTMLOptGroupElement&&p.querySelectorAll("option:not([disabled]):not([hidden]):not(.hidden)").length===0&&(p.disabled=!0,p.classList.add("hidden"))}}if(S){const p=c("<option></option>");p.attr({value:n,title:a}).text(o),p.appendTo(l),e.updateHiddenFieldValueFromSelect(s,u),e.markFieldAsChanged(u),e.Validation.validateField(s),e.Validation.validateField(C)}}else{const b=/_(\d+)$/,C=n.toString().match(b);C!=null&&(n=C[1]),l.val(n),e.Validation.validateField(s)}},e.updateHiddenFieldValueFromSelect=function(t,n){const o=Array.from(t.options).map(a=>a.value);n.value=o.join(","),n.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},e.getFieldElement=function(t,n,o){if(n){let a;switch(n){case"_list":a=c(f`:input[data-formengine-input-name="${t}"]:not([type=hidden])`,e.formElement);break;case"_avail":a=c(f`:input[data-relatedfieldname="${t}"]`,e.formElement);break;case"_mul":a=c(f`:input[type=hidden][data-formengine-input-name="${t}"]`,e.formElement);break;default:a=null;break}if(a&&a.length>0||o===!0)return a}return c(e.formElement.elements.namedItem(t))},e.initializeEvents=function(){top.TYPO3&&typeof top.TYPO3.Backend<"u"&&(top.TYPO3.Backend.consumerScope.attach(e),window.addEventListener("pagehide",()=>top.TYPO3.Backend.consumerScope.detach(e),{once:!0})),new h("click",t=>{t.preventDefault(),e.preventExitIfNotSaved(e.preventExitIfNotSavedCallback)}).delegateTo(document,".t3js-editform-close"),new h("click",t=>{t.preventDefault(),e.previewAction(t,e.previewActionCallback)}).delegateTo(document,".t3js-editform-view"),new h("click",t=>{t.preventDefault(),e.newAction(t,e.newActionCallback)}).delegateTo(document,".t3js-editform-new"),new h("click",t=>{t.preventDefault(),e.duplicateAction(t,e.duplicateActionCallback)}).delegateTo(document,".t3js-editform-duplicate"),new h("click",t=>{t.preventDefault(),e.deleteAction(t,e.deleteActionCallback)}).delegateTo(document,".t3js-editform-delete-record"),new h("change",(t,n)=>{n.closest(".t3js-formengine-field-item").classList.toggle("disabled")}).delegateTo(document,'.t3-form-field-eval-null-checkbox input[type="checkbox"]'),new h("change",(t,n)=>{e.toggleCheckboxField(n),e.markFieldAsChanged(n)}).delegateTo(document,'.t3js-form-field-eval-null-placeholder-checkbox input[type="checkbox"]'),new h("click",(t,n)=>{t.preventDefault(),t.stopPropagation();const o=n.dataset.mode,a=n.dataset.params,i=n.dataset.entryPoint;e.openPopupWindow(o,a,i)}).delegateTo(document,".t3js-element-browser"),new h("click",(t,n)=>{const o=JSON.parse(n.dataset.formengineFieldChangeItems);e.processOnFieldChange(o,t)}).delegateTo(document,'[data-formengine-field-change-event="click"]'),new h("change",(t,n)=>{const o=JSON.parse(n.dataset.formengineFieldChangeItems);e.processOnFieldChange(o,t)}).delegateTo(document,'[data-formengine-field-change-event="change"]'),e.formElement.addEventListener("submit",function(t){const n=t.target;if(n.closeDoc?.value==="0"&&t.submitter!==null&&(t.submitter.tagName==="A"||t.submitter.hasAttribute("form"))&&!t.defaultPrevented){const o=n.querySelector(f`input[name="${e.doSaveFieldName}"]`);o!==null&&(o.value="1")}}),window.addEventListener("message",e.handlePostMessage)},e.consume=function(t){if(!t)throw new Y.BackendException("No interaction request given",1496589980);let n;const o=new Promise((a,i)=>{n={resolve:a,reject:i}});if(t.concernsTypes(e.consumeTypes)){const a=t.outerMostRequest;e.interactionRequestMap.attachFor(a,n),a.isProcessed()?T(a,a.getProcessedData().response):e.hasChange()||e.isNew()?e.preventExitIfNotSaved(function(i){a.setProcessedData({response:i}),T(a,i)}):e.interactionRequestMap.resolveFor(a)}return o},e.handlePostMessage=function(t){if(!L.MessageUtility.verifyOrigin(t.origin))throw"Denied message sent by "+t.origin;if(t.data.actionName==="typo3:elementBrowser:elementAdded"){if(typeof t.data.fieldName>"u")throw"fieldName not defined in message";if(typeof t.data.value>"u")throw"value not defined in message";const n=t.data.label||t.data.value,o=t.data.title||n,a=F.trimExplode(",",t.data?.exclusiveValues??"");e.setSelectOptionFromExternalSource(t.data.fieldName,t.data.value,n,o,a)}},e.initializeRemainingCharacterViews=function(){document.querySelectorAll('[maxlength]:not([data-input-type="datetimepicker"]):not(.t3js-color-picker)').forEach(n=>{const o=n.closest(".t3js-formengine-field-item");if(o!==null&&o.querySelector("typo3-backend-formengine-char-counter")===null){const a=document.createElement("typo3-backend-formengine-char-counter");a.setAttribute("target",`[data-formengine-input-name="${f`${n.dataset.formengineInputName}`}"]`),o.append(a)}})},e.initializeMinimumCharactersLeftViews=function(){const t=(a,i)=>{const r=i.currentTarget.closest(".t3js-formengine-field-item"),s=r.querySelector(".t3js-charcounter-min"),l=TYPO3.lang["FormEngine.minCharactersLeft"].replace("{0}",a);if(s)s.querySelector("span").innerHTML=l;else{const d=document.createElement("div");d.classList.add("t3js-charcounter-min");const g=document.createElement("span");g.classList.add("badge","badge-danger"),g.innerHTML=l,d.append(g);let u=r.querySelector(".t3js-charcounter-wrapper");u||(u=document.createElement("div"),u.classList.add("t3js-charcounter-wrapper"),r.append(u)),u.prepend(d)}},n=a=>{const r=a.currentTarget.closest(".t3js-formengine-field-item").querySelector(".t3js-charcounter-min");r&&r.remove()};document.querySelectorAll('[minlength]:not([data-input-type="datetimepicker"]):not(.t3js-charcounter-min-initialized)').forEach(a=>{a.addEventListener("focus",i=>{const r=e.getMinCharacterLeftCount(a);r>0&&t(r,i)}),a.addEventListener("blur",n),a.addEventListener("keyup",i=>{const r=e.getMinCharacterLeftCount(a);r>0?t(r,i):n(i)})})},e.getMinCharacterLeftCount=function(t){const n=t.value,o=t.minLength,a=n.length;if(a===0)return 0;const i=(n.match(/\n/g)||[]).length;return o-a-i},e.initializeNullNoPlaceholderCheckboxes=function(){document.querySelectorAll(".t3-form-field-eval-null-checkbox").forEach(t=>{const n=t.querySelector('input[type="checkbox"]'),o=t.closest(".t3js-formengine-field-item");n.checked||o.classList.add("disabled")})},e.initializeNullWithPlaceholderCheckboxes=function(){document.querySelectorAll(".t3js-form-field-eval-null-placeholder-checkbox").forEach(t=>{e.toggleCheckboxField(t.querySelector('input[type="checkbox"]'),!1)})},e.toggleCheckboxField=function(t,n=!0){const o=t.closest(".t3js-formengine-field-item"),a=o.querySelector(".t3js-formengine-placeholder-placeholder"),i=o.querySelector(".t3js-formengine-placeholder-formfield");t.checked?(a.hidden=!0,i.hidden=!1,n&&i.querySelector("input,select,textarea")?.focus()):(a.hidden=!1,i.hidden=!0)},e.reinitialize=function(){const t=document.querySelectorAll(".t3js-clearable");t.length>0&&import("@typo3/backend/input/clearable.js").then(function(){t.forEach(n=>n.clearable())}),e.initializeNullNoPlaceholderCheckboxes(),e.initializeNullWithPlaceholderCheckboxes(),e.initializeLocalizationStateSelector(),e.initializeMinimumCharactersLeftViews(),e.initializeRemainingCharacterViews()},e.initializeLocalizationStateSelector=function(){document.querySelectorAll(".t3js-l10n-state-container").forEach(t=>{const n=t.closest(".t3js-formengine-field-item")?.querySelector("[data-formengine-input-name]");if(n==null)return;const o=t.querySelector('input[type="radio"]:checked')?.value;o===void 0&&console.warn("The localization state of the field "+n.dataset.formengineInputName+" cannot be determined. This smells like a DataHandler bug."),(o==="parent"||o==="source")&&(n.disabled=!0)})},e.hasChange=function(){const t=c(f`form[name="${e.formName}"] .has-change`).length>0,n=c('[name^="data["].has-change').length>0;return t||n},e.isNew=function(){return document.querySelector('form[name="'+e.formName+'"] .typo3-TCEforms.is-new')!==null},e.markFieldAsChanged=function(t){t.classList.add("has-change");const n=t.closest(".t3js-formengine-palette-field")?.querySelector(".t3js-formengine-label");n!==null&&n.classList.add("has-change")},e.preventExitIfNotSavedCallback=()=>{e.closeDocument()},e.preventFollowLinkIfNotSaved=function(t){return e.preventExitIfNotSaved(function(){window.location.href=t}),!1},e.preventExitIfNotSaved=function(t){if(t=t||e.preventExitIfNotSavedCallback,e.hasChange()||e.isNew()){const n=TYPO3.lang["label.confirm.close_without_save.title"]||"Unsaved changes",o=TYPO3.lang["label.confirm.close_without_save.content"]||"You currently have unsaved changes which will be discarded if you close without saving.",a=[{text:TYPO3.lang["buttons.confirm.close_without_save.no"]||"Keep editing",btnClass:"btn-default",name:"no"},{text:TYPO3.lang["buttons.confirm.close_without_save.yes"]||"Discard changes",btnClass:"btn-default",name:"yes"}];c(".has-error").length===0&&a.push({text:TYPO3.lang["buttons.confirm.save_and_close"]||"Save and close",btnClass:"btn-primary",name:"save",active:!0});const i=m.confirm(n,o,v.warning,a);i.addEventListener("button.clicked",function(r){r.target.name==="no"?i.hideModal():r.target.name==="yes"?(i.hideModal(),t.call(null,!0)):r.target.name==="save"&&(i.hideModal(),e.saveAndCloseDocument())})}else t.call(null,!0)},e.preventSaveIfHasErrors=function(){if(c(".has-error").length>0){const t=TYPO3.lang["label.alert.save_with_error.title"]||"You have errors in your form!",n=TYPO3.lang["label.alert.save_with_error.content"]||"Please check the form, there is at least one error in your form.",o=m.confirm(t,n,v.error,[{text:TYPO3.lang["buttons.alert.save_with_error.ok"]||"OK",btnClass:"btn-danger",name:"ok"}]);return o.addEventListener("button.clicked",function(a){a.target.name==="ok"&&o.hideModal()}),!1}return!0},e.processOnFieldChange=function(t,n){t.forEach(o=>{const a=y.get(o.name);a instanceof Function&&a.call(null,o.data||null,n)})},e.registerOnFieldChangeHandler=function(t,n){y.has(t)&&console.warn("Handler for onFieldChange name `"+t+"` has been overridden."),y.set(t,n)},e.closeModalsRecursive=function(){typeof m.currentModal<"u"&&m.currentModal!==null&&(m.currentModal.addEventListener("typo3-modal-hidden",function(){e.closeModalsRecursive()}),m.currentModal.hideModal())},e.previewAction=function(t,n){n=n||e.previewActionCallback;const o=t.target.href,a="isNew"in t.target.dataset,i=c("<input />").attr("type","hidden").attr("name","_savedokview").attr("value","1");e.hasChange()||e.isNew()?e.showPreviewModal(o,a,i,n):(c(f`form[name="${e.formName}"]`).append(i),window.open("","newTYPO3frontendWindow"),e.formElement.submit())},e.previewActionCallback=function(t,n,o){switch(m.dismiss(),t){case"discard":const a=window.open(n,"newTYPO3frontendWindow");a.focus(),F.urlsPointToSameServerSideResource(a.location.href,n)&&a.location.reload();break;case"save":c(f`form[name="${e.formName}"]`).append(c(o)),window.open("","newTYPO3frontendWindow"),e.saveDocument();break;default:break}},e.showPreviewModal=function(t,n,o,a){const i=TYPO3.lang["label.confirm.view_record_changed.title"]||"Do you want to save before viewing?",r={text:TYPO3.lang["buttons.confirm.view_record_changed.cancel"]||"Cancel",btnClass:"btn-default",name:"cancel"},s={text:TYPO3.lang["buttons.confirm.view_record_changed.no-save"]||"View without changes",btnClass:"btn-default",name:"discard"},l={text:TYPO3.lang["buttons.confirm.view_record_changed.save"]||"Save changes and view",btnClass:"btn-primary",name:"save",active:!0};let d=[],g=[];if(n){if(!e.Validation.isValid()){e.Validation.showErrorModal();return}d=[r,l],g=[TYPO3.lang["label.confirm.view_record_changed.content.is-new-page"]||"You need to save your changes before viewing the page. Do you want to save and view them now?"]}else d=[r,s],g=[TYPO3.lang["label.confirm.view_record_changed.content"]||"You currently have unsaved changes. You can either discard these changes or save and view them."],e.Validation.isValid()?d.push(l):g.push(TYPO3.lang["label.confirm.view_record_changed.invalid_form"]||'The form appears to be invalid, therefore "Save changes and view" is not available.');const u=document.createElement("p");g.forEach((b,C)=>{u.append(b),C!==g.length-1&&u.append(document.createElement("br"))});const E=m.confirm(i,u,v.info,d);E.addEventListener("button.clicked",function(b){a(b.target.name,t,o,E)})},e.newAction=function(t,n){n=n||e.newActionCallback;const o=c("<input />").attr("type","hidden").attr("name","_savedoknew").attr("value","1"),a="isNew"in t.target.dataset;e.hasChange()||e.isNew()?e.showNewModal(a,o,n):(c(f`form[name="${e.formName}"]`).append(o),e.formElement.submit())},e.newActionCallback=function(t,n){const o=c(f`form[name="${e.formName}"]`);switch(m.dismiss(),t){case"no":o.append(n),e.formElement.submit();break;case"yes":o.append(n),e.saveDocument();break;default:break}},e.showNewModal=function(t,n,o){const a=TYPO3.lang["label.confirm.new_record_changed.title"]||"Do you want to save before adding?",i=TYPO3.lang["label.confirm.new_record_changed.content"]||"You need to save your changes before creating a new record. Do you want to save and create now?";let r=[];const s={text:TYPO3.lang["buttons.confirm.new_record_changed.cancel"]||"Cancel",btnClass:"btn-default",name:"cancel"},l={text:TYPO3.lang["buttons.confirm.new_record_changed.no"]||"No, just add",btnClass:"btn-default",name:"no"},d={text:TYPO3.lang["buttons.confirm.new_record_changed.yes"]||"Yes, save and create now",btnClass:"btn-primary",name:"yes",active:!0};t?r=[s,d]:r=[s,l,d],m.confirm(a,i,v.info,r).addEventListener("button.clicked",function(u){o(u.target.name,n)})},e.duplicateAction=function(t,n){n=n||e.duplicateActionCallback;const o=c("<input />").attr("type","hidden").attr("name","_duplicatedoc").attr("value","1"),a="isNew"in t.target.dataset;e.hasChange()||e.isNew()?e.showDuplicateModal(a,o,n):(c(f`form[name="${e.formName}"]`).append(o),e.formElement.submit())},e.duplicateActionCallback=function(t,n){const o=c(f`form[name="${e.formName}"]`);switch(m.dismiss(),t){case"no":o.append(n),e.formElement.submit();break;case"yes":o.append(n),e.saveDocument();break;default:break}},e.showDuplicateModal=function(t,n,o){const a=TYPO3.lang["label.confirm.duplicate_record_changed.title"]||"Do you want to save before duplicating this record?",i=TYPO3.lang["label.confirm.duplicate_record_changed.content"]||"You currently have unsaved changes. Do you want to save your changes before duplicating this record?";let r=[];const s={text:TYPO3.lang["buttons.confirm.duplicate_record_changed.cancel"]||"Cancel",btnClass:"btn-default",name:"cancel"},l={text:TYPO3.lang["buttons.confirm.duplicate_record_changed.no"]||"No, just duplicate the original",btnClass:"btn-default",name:"no"},d={text:TYPO3.lang["buttons.confirm.duplicate_record_changed.yes"]||"Yes, save and duplicate this record",btnClass:"btn-primary",name:"yes",active:!0};t?r=[s,d]:r=[s,l,d],m.confirm(a,i,v.info,r).addEventListener("button.clicked",function(u){o(u.target.name,n)})},e.deleteAction=function(t,n){n=n||e.deleteActionCallback;const o=c(t.target);e.showDeleteModal(o,n)},e.deleteActionCallback=function(t,n){m.dismiss(),t==="yes"&&e.invokeRecordDeletion(n)},e.showDeleteModal=function(t,n){const o=TYPO3.lang["label.confirm.delete_record.title"]||"Delete this record?";let a=(TYPO3.lang["label.confirm.delete_record.content"]||"Are you sure you want to delete the record '%s'?").replace("%s",t.data("record-info"));t.data("reference-count-message")&&(a+=`
`+t.data("reference-count-message")),t.data("translation-count-message")&&(a+=`
`+t.data("translation-count-message")),m.confirm(o,a,v.warning,[{text:TYPO3.lang["buttons.confirm.delete_record.no"]||"Cancel",btnClass:"btn-default",name:"no"},{text:TYPO3.lang["buttons.confirm.delete_record.yes"]||"Yes, delete this record",btnClass:"btn-warning",name:"yes",active:!0}]).addEventListener("button.clicked",function(r){n(r.target.name,t)})},e.enableOptGroup=function(t){const n=t.parentElement;n instanceof HTMLOptGroupElement&&n.querySelectorAll("option:not([hidden]):not([disabled]):not(.hidden)").length&&(n.hidden=!1,n.disabled=!1,n.classList.remove("hidden"))},e.closeDocument=function(){e.formElement.closeDoc.value=1,e.formElement.submit()},e.saveDocument=function(){const t=document.activeElement;(t instanceof HTMLInputElement||t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement)&&t.blur();const n=e.formElement.querySelector(f`input[name="${e.doSaveFieldName}"]`);n!==null&&(n.value="1"),e.formElement.requestSubmit()},e.saveAndCloseDocument=function(){const t=document.createElement("input");t.type="hidden",t.name="_saveandclosedok",t.value="1",document.querySelector(f`form[name="${e.formName}"]`).append(t),e.saveDocument()},e.initialize=function(t,n){e.browserUrl=t,e.doSaveFieldName=n||"doSave",M.ready().then(()=>{e.initializeEvents(),e.Validation.initialize(this),e.reinitialize(),c("#t3js-ui-block").remove(),e.formElement.dispatchEvent(new Event("typo3:form-engine:ready")),P=!0,k.setScope("backend/form-engine"),k.register([k.normalizedCtrlModifierKey,"s"],o=>{o.preventDefault(),e.saveDocument()},{scope:"backend/form-engine",allowOnEditables:!0,bindElement:e.formElement._savedok}),k.register([k.normalizedCtrlModifierKey,A.SHIFT,"s"],o=>{o.preventDefault(),e.saveAndCloseDocument()},{scope:"backend/form-engine",allowOnEditables:!0})})},e.invokeRecordDeletion=function(t){window.location.href=t.attr("href")},TYPO3.FormEngine=e,e}();export{D as default};
