/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
import{property as p,query as d,customElement as u}from"lit/decorators.js";import{LitElement as h,css as f,html as m}from"lit";import y from"alwan";import v from"@typo3/core/event/regular-event.js";var l=function(s,o,t,e){var i=arguments.length,r=i<3?o:e===null?e=Object.getOwnPropertyDescriptor(o,t):e,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,o,t,e);else for(var a=s.length-1;a>=0;a--)(c=s[a])&&(r=(i<3?c(r):i>3?c(o,t,r):c(o,t))||r);return i>3&&r&&Object.defineProperty(o,t,r),r};let n=class extends h{constructor(){super(...arguments),this.color="",this.opacity=!1,this.swatches=""}static{this.styles=f`:host{display:inline-block;position:relative}.color-picker-preview{display:block;position:absolute;width:1.25rem;height:1.25rem;top:50%;inset-inline-start:var(--typo3-input-sm-padding-x);z-index:10;transform:translateY(-50%);background:var(--alwan-pattern);border-radius:3px!important;pointer-events:none}.color-picker-preview-color{position:absolute;inset:0;border-radius:2px;background-color:var(--color,transparent)}`}firstUpdated(){const o=this.getInputElement();if(o){if(!o.value&&this.color?o.value=this.color:this.color=o.value,o.disabled||o.readOnly)return;const t=new y(o,{position:"bottom-start",format:"hex",opacity:this.opacity,swatches:this.swatches?this.swatches.split(";"):[],preset:!1,color:this.color});t.on("color",e=>{this.color=e.hex,o.value=this.color,o.dispatchEvent(new Event("blur"))}),["input","change"].forEach(e=>{new v(e,i=>{const r=i.target;this.color=r.value,t.setColor(this.color)}).bindTo(o)})}}render(){return m`<slot></slot><span style=--color:${this.color} class=color-picker-preview><span class=color-picker-preview-color></span></span>`}getInputElement(){const o=this.slotEl.assignedNodes();for(const t of o)if(t instanceof HTMLInputElement)return t;return console.warn("No input element found in the slot."),null}};l([p({type:String})],n.prototype,"color",void 0),l([p({type:Boolean})],n.prototype,"opacity",void 0),l([p({type:String})],n.prototype,"swatches",void 0),l([d("slot")],n.prototype,"slotEl",void 0),n=l([u("typo3-backend-color-picker")],n);class w{initialize(o,t={}){if(o.parentElement instanceof n)return;const e=document.createElement("typo3-backend-color-picker");e.swatches=t.swatches?.join(";")??"",e.opacity=t.opacity??!1,o.parentNode.insertBefore(e,o),e.appendChild(o)}}var b=new w;export{n as Typo3BackendColorPicker,b as default};
