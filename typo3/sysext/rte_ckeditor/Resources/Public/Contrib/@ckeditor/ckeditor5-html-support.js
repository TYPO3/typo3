import{Plugin as g}from"@ckeditor/ckeditor5-core";import{toArray as I,priorities as _,CKEditorError as Jt,isValidAttributeName as Zt,uid as et,logWarning as te,global as rt}from"@ckeditor/ckeditor5-utils";import{Matcher as it,StylesMap as ee,ViewUpcastWriter as W,HtmlDataProcessor as re}from"@ckeditor/ckeditor5-engine";import{toWidget as ot,Widget as ie}from"@ckeditor/ckeditor5-widget";import{Enter as oe}from"@ckeditor/ckeditor5-enter";function ne(e){return e==="__proto__"}function z(e){return e==null||typeof e!="object"&&typeof e!="function"}function se(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function T(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function x(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const nt="[object RegExp]",q="[object String]",G="[object Number]",K="[object Boolean]",R="[object Arguments]",st="[object Symbol]",lt="[object Date]",mt="[object Map]",at="[object Set]",ct="[object Array]",le="[object Function]",ut="[object ArrayBuffer]",H="[object Object]",me="[object Error]",dt="[object DataView]",ft="[object Uint8Array]",ht="[object Uint8ClampedArray]",gt="[object Uint16Array]",bt="[object Uint32Array]",ae="[object BigUint64Array]",pt="[object Int8Array]",wt="[object Int16Array]",yt="[object Int32Array]",ce="[object BigInt64Array]",At="[object Float32Array]",vt="[object Float64Array]";function X(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ue(e,t){return k(e,void 0,e,new Map,t)}function k(e,t,i,r=new Map,o=void 0){const n=o?.(e,t,i,r);if(n!=null)return n;if(z(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const s=new Array(e.length);r.set(e,s);for(let l=0;l<e.length;l++)s[l]=k(e[l],l,i,r,o);return Object.hasOwn(e,"index")&&(s.index=e.index),Object.hasOwn(e,"input")&&(s.input=e.input),s}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const s=new RegExp(e.source,e.flags);return s.lastIndex=e.lastIndex,s}if(e instanceof Map){const s=new Map;r.set(e,s);for(const[l,m]of e)s.set(l,k(m,l,i,r,o));return s}if(e instanceof Set){const s=new Set;r.set(e,s);for(const l of e)s.add(k(l,void 0,i,r,o));return s}if(typeof Buffer<"u"&&Buffer.isBuffer(e))return e.subarray();if(X(e)){const s=new(Object.getPrototypeOf(e)).constructor(e.length);r.set(e,s);for(let l=0;l<e.length;l++)s[l]=k(e[l],l,i,r,o);return s}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const s=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,s),v(s,e,i,r,o),s}if(typeof File<"u"&&e instanceof File){const s=new File([e],e.name,{type:e.type});return r.set(e,s),v(s,e,i,r,o),s}if(e instanceof Blob){const s=new Blob([e],{type:e.type});return r.set(e,s),v(s,e,i,r,o),s}if(e instanceof Error){const s=new e.constructor;return r.set(e,s),s.message=e.message,s.name=e.name,s.stack=e.stack,s.cause=e.cause,v(s,e,i,r,o),s}if(typeof e=="object"&&de(e)){const s=Object.create(Object.getPrototypeOf(e));return r.set(e,s),v(s,e,i,r,o),s}return e}function v(e,t,i=e,r,o){const n=[...Object.keys(t),...T(t)];for(let s=0;s<n.length;s++){const l=n[s],m=Object.getOwnPropertyDescriptor(e,l);(m==null||m.writable)&&(e[l]=k(t[l],l,i,r,o))}}function de(e){switch(x(e)){case R:case ct:case ut:case dt:case K:case lt:case At:case vt:case pt:case wt:case yt:case mt:case G:case H:case nt:case at:case q:case st:case ft:case ht:case gt:case bt:return!0;default:return!1}}function fe(e,t){return ue(e,(i,r,o,n)=>{if(typeof e=="object")switch(Object.prototype.toString.call(e)){case G:case q:case K:{const s=new e.constructor(e?.valueOf());return v(s,e),s}case R:{const s={};return v(s,e),s.length=e.length,s[Symbol.iterator]=e[Symbol.iterator],s}default:return}})}function Y(e){return fe(e)}function Et(e){return e!==null&&typeof e=="object"&&x(e)==="[object Arguments]"}function St(e){return typeof e=="object"&&e!==null}function Ot(e){if(e==null)return"";if(typeof e=="string")return e;if(Array.isArray(e))return e.map(Ot).join(",");const t=String(e);return t==="0"&&Object.is(Number(e),-0)?"-0":t}function kt(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}function he(e,t,i){return $(e,t,void 0,void 0,void 0,void 0,i)}function $(e,t,i,r,o,n,s){const l=s(e,t,i,r,o,n);if(l!==void 0)return l;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return B(e,t,n,s)}return B(e,t,n,s)}function B(e,t,i,r){if(Object.is(e,t))return!0;let o=x(e),n=x(t);if(o===R&&(o=H),n===R&&(n=H),o!==n)return!1;switch(o){case q:return e.toString()===t.toString();case G:{const m=e.valueOf(),a=t.valueOf();return se(m,a)}case K:case lt:case st:return Object.is(e.valueOf(),t.valueOf());case nt:return e.source===t.source&&e.flags===t.flags;case le:return e===t}i=i??new Map;const s=i.get(e),l=i.get(t);if(s!=null&&l!=null)return s===t;i.set(e,t),i.set(t,e);try{switch(o){case mt:{if(e.size!==t.size)return!1;for(const[m,a]of e.entries())if(!t.has(m)||!$(a,t.get(m),m,e,t,i,r))return!1;return!0}case at:{if(e.size!==t.size)return!1;const m=Array.from(e.values()),a=Array.from(t.values());for(let c=0;c<m.length;c++){const u=m[c],d=a.findIndex(h=>$(u,h,void 0,e,t,i,r));if(d===-1)return!1;a.splice(d,1)}return!0}case ct:case ft:case ht:case gt:case bt:case ae:case pt:case wt:case yt:case ce:case At:case vt:{if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let m=0;m<e.length;m++)if(!$(e[m],t[m],m,e,t,i,r))return!1;return!0}case ut:return e.byteLength!==t.byteLength?!1:B(new Uint8Array(e),new Uint8Array(t),i,r);case dt:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:B(new Uint8Array(e),new Uint8Array(t),i,r);case me:return e.name===t.name&&e.message===t.message;case H:{if(!(B(e.constructor,t.constructor,i,r)||kt(e)&&kt(t)))return!1;const a=[...Object.keys(e),...T(e)],c=[...Object.keys(t),...T(t)];if(a.length!==c.length)return!1;for(let u=0;u<a.length;u++){const d=a[u],h=e[d];if(!Object.hasOwn(t,d))return!1;const p=t[d];if(!$(h,p,d,e,t,i,r))return!1}return!0}default:return!1}}finally{i.delete(e),i.delete(t)}}function ge(){}function Ft(e,t){return he(e,t,ge)}function be(e){return X(e)}function Ct(e){if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){const i=e[Symbol.toStringTag];return i==null||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable?!1:e.toString()===`[object ${i}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function pe(e){if(z(e))return e;if(Array.isArray(e)||X(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e),i=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new i(e);if(e instanceof RegExp){const r=new i(e);return r.lastIndex=e.lastIndex,r}if(e instanceof DataView)return new i(e.buffer.slice(0));if(e instanceof Error){const r=new i(e.message);return r.stack=e.stack,r.name=e.name,r.cause=e.cause,r}if(typeof File<"u"&&e instanceof File)return new i([e],e.name,{type:e.type,lastModified:e.lastModified});if(typeof e=="object"){const r=Object.create(t);return Object.assign(r,e)}return e}function we(e,...t){const i=t.slice(0,-1),r=t[t.length-1];let o=e;for(let n=0;n<i.length;n++){const s=i[n];o=M(o,s,r,new Map)}return o}function M(e,t,i,r){if(z(e)&&(e=Object(e)),t==null||typeof t!="object")return e;if(r.has(t))return pe(r.get(t));if(r.set(t,e),Array.isArray(t)){t=t.slice();for(let n=0;n<t.length;n++)t[n]=t[n]??void 0}const o=[...Object.keys(t),...T(t)];for(let n=0;n<o.length;n++){const s=o[n];if(ne(s))continue;let l=t[s],m=e[s];if(Et(l)&&(l={...l}),Et(m)&&(m={...m}),typeof Buffer<"u"&&Buffer.isBuffer(l)&&(l=Y(l)),Array.isArray(l))if(typeof m=="object"&&m!=null){const c=[],u=Reflect.ownKeys(m);for(let d=0;d<u.length;d++){const h=u[d];c[h]=m[h]}m=c}else m=[];const a=i(m,l,s,e,t,r);a!=null?e[s]=a:Array.isArray(l)||St(m)&&St(l)?e[s]=M(m,l,i,r):m==null&&Ct(l)?e[s]=M({},l,i,r):m==null&&be(l)?e[s]=Y(l):(m===void 0||l!==void 0)&&(e[s]=l)}return e}const ye=/\p{Lu}?\p{Ll}+|[0-9]+|\p{Lu}+(?!\p{Ll})|\p{Emoji_Presentation}|\p{Extended_Pictographic}|\p{L}+/gu;function Ae(e){return Array.from(e.match(ye)??[])}function ve(e){return typeof e!="string"&&(e=Ot(e)),e.replace(/['\u2019]/g,"")}function Ee(e){const t=Ae(ve(e).trim());let i="";for(let r=0;r<t.length;r++){const o=t[r];i&&(i+=" "),o===o.toUpperCase()?i+=o:i+=o[0].toUpperCase()+o.slice(1).toLowerCase()}return i}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function w(e,t,i,r){t&&Pt(e,t,r),i&&y(e,i,r)}function y(e,t,i){if(t.attributes)for(const[r,o]of Object.entries(t.attributes))e.setAttribute(r,o,i);t.styles&&e.setStyle(t.styles,i),t.classes&&e.addClass(t.classes,i)}function Pt(e,t,i){if(t.attributes)for(const[r]of Object.entries(t.attributes))e.removeAttribute(r,i);if(t.styles)for(const r of Object.keys(t.styles))e.removeStyle(r,i);t.classes&&e.removeClass(t.classes,i)}function It(e,t){const i=Y(e);let r="attributes";for(r in t)r=="classes"?i[r]=Array.from(new Set([...e[r]||[],...t[r]])):i[r]={...e[r],...t[r]};return i}function E(e,t,i,r,o){const n=t.getAttribute(i),s={};for(const l of["attributes","styles","classes"]){if(l!=r){n&&n[l]&&(s[l]=n[l]);continue}if(r=="classes"){const a=new Set(n&&n.classes||[]);o(a),a.size&&(s[l]=Array.from(a));continue}const m=new Map(Object.entries(n&&n[l]||{}));o(m),m.size&&(s[l]=Object.fromEntries(m))}Object.keys(s).length?t.is("documentSelection")?e.setSelectionAttribute(i,s):e.setAttribute(i,s,t):n&&(t.is("documentSelection")?e.removeSelectionAttribute(i):e.removeAttribute(i,t))}function Se(e,t,i){for(const r of t.getItems({shallow:!0})){const o=r.getAttribute(e);o&&o.attributes&&Object.keys(o.attributes).length?Object.keys(o).length>1&&i.setAttribute(e,{attributes:o.attributes},r):i.removeAttribute(e,r)}}function _t(e){return Ee(e).replace(/ /g,"")}function b(e){return`html${_t(e)}Attributes`}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function V({model:e}){return(t,i)=>i.writer.createElement(e,{htmlContent:t.getCustomProperty("$rawContent")})}function $t(e,{view:t,isInline:i}){const r=e.t;return(o,{writer:n})=>{const s=r("HTML object"),l=D(t,o,n),m=o.getAttribute(b(t));n.addClass("html-object-embed__content",l),m&&y(n,m,l);const a=n.createContainerElement(i?"span":"div",{class:"html-object-embed","data-html-object-embed-label":s},l);return ot(a,n,{label:s})}}function D(e,t,i){return i.createRawElement(e,null,(r,o)=>{o.setContentOf(r,t.getAttribute("htmlContent"))})}function Bt({view:e,model:t,allowEmpty:i},r){return n=>{n.on(`element:${e}`,(s,l,m)=>{let a=r.processViewAttributes(l.viewItem,m);if(!(!a&&!m.consumable.test(l.viewItem,{name:!0}))){if(a=a||{},m.consumable.consume(l.viewItem,{name:!0}),l.modelRange||(l=Object.assign(l,m.convertChildren(l.viewItem,l.modelCursor))),i&&l.modelRange.isCollapsed&&Object.keys(a).length){const c=m.writer.createElement("htmlEmptyElement");if(!m.safeInsert(c,l.modelCursor))return;const u=m.getSplitParts(c);l.modelRange=m.writer.createRange(l.modelRange.start,m.writer.createPositionAfter(u[u.length-1])),m.updateConversionResult(c,l),o(c,a,m);return}for(const c of l.modelRange.getItems())o(c,a,m)}},{priority:"low"})};function o(n,s,l){if(l.schema.checkAttribute(n,t)){const m=n.getAttribute(t),a=It(s,m||{});l.writer.setAttribute(t,a,n)}}}function Q({model:e,view:t},i){return(r,{writer:o,consumable:n})=>{if(!r.hasAttribute(e))return null;const s=o.createContainerElement(t),l=r.getAttribute(e);return n.consume(r,`attribute:${e}`),y(o,l,s),s.getFillerOffset=()=>null,i?ot(s,o):s}}function Dt({priority:e,view:t}){return(i,r)=>{if(!i)return;const{writer:o}=r,n=o.createAttributeElement(t,null,{priority:e});return y(o,i,n),n}}function S({view:e},t){return i=>{i.on(`element:${e}`,(r,o,n)=>{if(!o.modelRange||o.modelRange.isCollapsed)return;const s=t.processViewAttributes(o.viewItem,n);s&&n.writer.setAttribute(b(o.viewItem.name),s,o.modelRange)},{priority:"low"})}}function F({view:e,model:t}){return i=>{i.on(`attribute:${b(e)}:${t}`,(r,o,n)=>{if(!n.consumable.consume(o.item,r.name))return;const{attributeOldValue:s,attributeNewValue:l}=o,m=n.writer,a=n.mapper.toViewElement(o.item);w(m,s,l,a)})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const J={block:[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"horizontalLine",view:"hr"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6","$text"],allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowIn:["$root","$container"],allowChildren:["paragraph","htmlP","htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlHr",view:"hr",isEmpty:!0,modelSchema:{inheritAllFrom:"$blockObject"}}],inline:[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref",attributeProperties:{isFormatting:!0}},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}]};/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class O extends g{_definitions=[];static get pluginName(){return"DataSchema"}static get isOfficialPlugin(){return!0}init(){for(const t of J.block)this.registerBlockElement(t);for(const t of J.inline)this.registerInlineElement(t)}registerBlockElement(t){this._definitions.push({...t,isBlock:!0})}registerInlineElement(t){this._definitions.push({...t,isInline:!0})}extendBlockElement(t){this._extendDefinition({...t,isBlock:!0})}extendInlineElement(t){this._extendDefinition({...t,isInline:!0})}getDefinitionsForView(t,i=!1){const r=new Set;for(const o of this._getMatchingViewDefinitions(t)){if(i)for(const n of this._getReferences(o.model))r.add(n);r.add(o)}return r}getDefinitionsForModel(t){return this._definitions.filter(i=>i.model==t)}_getMatchingViewDefinitions(t){return this._definitions.filter(i=>i.view&&Oe(t,i.view))}*_getReferences(t){const i=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],r=this._definitions.filter(o=>o.model==t);for(const{modelSchema:o}of r)if(o)for(const n of i)for(const s of I(o[n]||[])){const l=this._definitions.filter(m=>m.model==s);for(const m of l)s!==t&&(yield*this._getReferences(m.model),yield m)}}_extendDefinition(t){const i=Array.from(this._definitions.entries()).filter(([,r])=>r.model==t.model);if(i.length==0){this._definitions.push(t);return}for(const[r,o]of i)this._definitions[r]=we({},o,t,(n,s)=>Array.isArray(n)?n.concat(s):void 0)}}function Oe(e,t){return typeof e=="string"?e===t:e instanceof RegExp?e.test(t):!1}function ke(e,{insertAt:t}={}){if(typeof document>"u")return;const i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",window.litNonce&&r.setAttribute("nonce",window.litNonce),t==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}ke(":root{--ck-html-object-embed-unfocused-outline-width:1px}.ck-widget.html-object-embed{background-color:var(--ck-color-base-foreground);font-size:var(--ck-font-size-base);min-width:calc(76px + var(--ck-spacing-standard));padding:var(--ck-spacing-small);padding-top:calc(var(--ck-font-size-tiny) + var(--ck-spacing-large))}.ck-widget.html-object-embed:not(.ck-widget_selected):not(:hover){outline:var(--ck-html-object-embed-unfocused-outline-width) dashed var(--ck-color-widget-blurred-border)}.ck-widget.html-object-embed:before{background:#999;border-radius:0 0 var(--ck-border-radius) var(--ck-border-radius);color:var(--ck-color-base-background);content:attr(data-html-object-embed-label);font-family:var(--ck-font-face);font-size:var(--ck-font-size-tiny);font-style:normal;font-weight:400;left:var(--ck-spacing-standard);padding:calc(var(--ck-spacing-tiny) + var(--ck-html-object-embed-unfocused-outline-width)) var(--ck-spacing-small) var(--ck-spacing-tiny);position:absolute;top:0;transition:background var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck-widget.html-object-embed .ck-widget__type-around .ck-widget__type-around__button.ck-widget__type-around__button_before{margin-left:50px}.ck-widget.html-object-embed .html-object-embed__content{pointer-events:none}div.ck-widget.html-object-embed{margin:1em auto}span.ck-widget.html-object-embed{display:inline-block}");/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class f extends g{_dataSchema;_allowedAttributes;_disallowedAttributes;_allowedElements;_disallowedElements;_dataInitialized;_coupledAttributes;constructor(t){super(t),this._dataSchema=t.plugins.get("DataSchema"),this._allowedAttributes=new it,this._disallowedAttributes=new it,this._allowedElements=new Set,this._disallowedElements=new Set,this._dataInitialized=!1,this._coupledAttributes=null,this._registerElementsAfterInit(),this._registerElementHandlers(),this._registerCoupledAttributesPostFixer(),this._registerAssociatedHtmlAttributesPostFixer()}static get pluginName(){return"DataFilter"}static get isOfficialPlugin(){return!0}static get requires(){return[O,ie]}loadAllowedConfig(t){for(const i of t){const r=i.name||/[\s\S]+/,o=Tt(i);this.allowElement(r),o.forEach(n=>this.allowAttributes(n))}}loadDisallowedConfig(t){for(const i of t){const r=i.name||/[\s\S]+/,o=Tt(i);o.length==0?this.disallowElement(r):o.forEach(n=>this.disallowAttributes(n))}}loadAllowedEmptyElementsConfig(t){for(const i of t)this.allowEmptyElement(i)}allowElement(t){for(const i of this._dataSchema.getDefinitionsForView(t,!0))this._addAllowedElement(i),this._coupledAttributes=null}disallowElement(t){for(const i of this._dataSchema.getDefinitionsForView(t,!1))this._disallowedElements.add(i.view)}allowEmptyElement(t){for(const i of this._dataSchema.getDefinitionsForView(t,!0))i.isInline&&this._dataSchema.extendInlineElement({...i,allowEmpty:!0})}allowAttributes(t){this._allowedAttributes.add(t)}disallowAttributes(t){this._disallowedAttributes.add(t)}processViewAttributes(t,i){const{consumable:r}=i;return jt(t,this._disallowedAttributes,r),Fe(t,jt(t,this._allowedAttributes,r))}_addAllowedElement(t){if(!this._allowedElements.has(t)){if(this._allowedElements.add(t),"appliesToBlock"in t&&typeof t.appliesToBlock=="string")for(const i of this._dataSchema.getDefinitionsForModel(t.appliesToBlock))i.isBlock&&this._addAllowedElement(i);this._dataInitialized&&this.editor.data.once("set",()=>{this._fireRegisterEvent(t)},{priority:_.highest+1})}}_registerElementsAfterInit(){this.editor.data.on("init",()=>{this._dataInitialized=!0;for(const t of this._allowedElements)this._fireRegisterEvent(t)},{priority:_.highest+1})}_registerElementHandlers(){this.on("register",(t,i)=>{const r=this.editor.model.schema;if(i.isObject&&!r.isRegistered(i.model))this._registerObjectElement(i);else if(i.isBlock)this._registerBlockElement(i);else if(i.isInline)this._registerInlineElement(i);else throw new Jt("data-filter-invalid-definition",null,i);t.stop()},{priority:"lowest"})}_registerCoupledAttributesPostFixer(){const t=this.editor.model,i=t.document.selection;t.document.registerPostFixer(r=>{const o=t.document.differ.getChanges();let n=!1;const s=this._getCoupledAttributesMap();for(const l of o){if(l.type!="attribute"||l.attributeNewValue!==null)continue;const m=s.get(l.attributeKey);if(m)for(const{item:a}of l.range.getWalker())for(const c of m)a.hasAttribute(c)&&(r.removeAttribute(c,a),n=!0)}return n}),this.listenTo(i,"change:attribute",(r,{attributeKeys:o})=>{const n=new Set,s=this._getCoupledAttributesMap();for(const l of o){if(i.hasAttribute(l))continue;const m=s.get(l);if(m)for(const a of m)i.hasAttribute(a)&&n.add(a)}n.size!=0&&t.change(l=>{for(const m of n)l.removeSelectionAttribute(m)})})}_registerAssociatedHtmlAttributesPostFixer(){const t=this.editor.model;t.document.registerPostFixer(i=>{const r=t.document.differ.getChanges();let o=!1;for(const n of r)if(!(n.type!=="insert"||n.name==="$text"))for(const s of n.attributes.keys())!s.startsWith("html")||!s.endsWith("Attributes")||t.schema.checkAttribute(n.name,s)||(i.removeAttribute(s,n.position.nodeAfter),o=!0);return o})}_getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map;for(const t of this._allowedElements)if(t.coupledAttribute&&t.model){const i=this._coupledAttributes.get(t.coupledAttribute);i?i.push(t.model):this._coupledAttributes.set(t.coupledAttribute,[t.model])}return this._coupledAttributes}_fireRegisterEvent(t){t.view&&this._disallowedElements.has(t.view)||this.fire(t.view?`register:${t.view}`:"register",t)}_registerObjectElement(t){const i=this.editor,r=i.model.schema,o=i.conversion,{view:n,model:s}=t;r.register(s,t.modelSchema);/* istanbul ignore next: paranoid check -- @preserve */n&&(r.extend(t.model,{allowAttributes:[b(n),"htmlContent"]}),i.data.registerRawContentMatcher({name:n}),o.for("upcast").elementToElement({view:n,model:V(t),converterPriority:_.low+2}),o.for("upcast").add(S(t,this)),o.for("editingDowncast").elementToStructure({model:{name:s,attributes:[b(n)]},view:$t(i,t)}),o.for("dataDowncast").elementToElement({model:s,view:(l,{writer:m})=>D(n,l,m)}),o.for("dataDowncast").add(F(t)))}_registerBlockElement(t){const i=this.editor,r=i.model.schema,o=i.conversion,{view:n,model:s}=t;if(!r.isRegistered(t.model)){if(!t.modelSchema||(r.register(t.model,t.modelSchema),!n))return;o.for("upcast").elementToElement({model:s,view:n,converterPriority:_.low+2}),o.for("downcast").elementToElement({model:s,view:(l,{writer:m})=>t.isEmpty?m.createEmptyElement(n):m.createContainerElement(n)})}n&&(r.extend(t.model,{allowAttributes:b(n)}),o.for("upcast").add(S(t,this)),o.for("downcast").add(F(t)))}_registerInlineElement(t){const i=this.editor,r=i.model.schema,o=i.conversion,n=t.model;if(!t.appliesToBlock&&(r.extend("$text",{allowAttributes:n}),t.attributeProperties&&r.setAttributeProperties(n,t.attributeProperties),o.for("upcast").add(Bt(t,this)),o.for("downcast").attributeToElement({model:n,view:Dt(t)}),!!t.allowEmpty)){if(r.setAttributeProperties(n,{copyFromObject:!1}),!r.isRegistered("htmlEmptyElement")){r.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"});const s=l=>Array.from(l.getAttributeKeys()).some(m=>m.startsWith("html"));i.model.document.registerPostFixer(l=>{const m=i.model.document.differ.getChanges(),a=new Set;for(const c of m)if(c.type!=="remove"){if(c.type==="attribute"&&c.attributeNewValue===null)for(const{item:u}of c.range)u.is("element","htmlEmptyElement")&&!s(u)&&a.add(u);if(c.type==="insert"&&c.position.nodeAfter){const u=c.position.nodeAfter;for(const{item:d}of l.createRangeOn(u))d.is("element","htmlEmptyElement")&&!s(d)&&a.add(d)}}for(const c of a)l.remove(c);return a.size>0})}i.data.htmlProcessor.domConverter.registerInlineObjectMatcher(s=>s.name==t.view&&s.isEmpty&&Array.from(s.getAttributeKeys()).length?{name:!0}:null),o.for("editingDowncast").elementToElement({model:"htmlEmptyElement",view:Q(t,!0)}),o.for("dataDowncast").elementToElement({model:"htmlEmptyElement",view:Q(t)})}}}function jt(e,t,i){const r=t.matchAll(e)||[],o=e.document.stylesProcessor;return r.reduce((n,{match:s})=>{for(const[l,m]of s.attributes||[])if(l=="style"){const a=m,c=o.getRelatedStyles(a).filter(u=>u.split("-").length>a.split("-").length).sort((u,d)=>d.split("-").length-u.split("-").length);for(const u of c)i.consume(e,{styles:[u]})&&n.styles.push(u);i.consume(e,{styles:[a]})&&n.styles.push(a)}else if(l=="class"){const a=m;i.consume(e,{classes:[a]})&&n.classes.push(a)}else i.consume(e,{attributes:[l]})&&n.attributes.push(l);return n},{attributes:[],classes:[],styles:[]})}function Fe(e,{attributes:t,classes:i,styles:r}){return!t.length&&!i.length&&!r.length?null:{...t.length&&{attributes:Ce(e,t)},...r.length&&{styles:Pe(e,r)},...i.length&&{classes:i}}}function Ce(e,t){const i={};for(const r of t){const o=e.getAttribute(r);o!==void 0&&Zt(r)&&(i[r]=o)}return i}function Pe(e,t){const i=new ee(e.document.stylesProcessor);for(const r of t){const o=e.getStyle(r);o!==void 0&&i.set(r,o)}return Object.fromEntries(i.getStylesEntries())}function Z(e,t){const{name:i}=e,r=e[t];return Ct(r)?Object.entries(r).map(([o,n])=>({name:i,[t]:{[o]:n}})):Array.isArray(r)?r.map(o=>({name:i,[t]:[o]})):[e]}function Tt(e){const{name:t,attributes:i,classes:r,styles:o}=e,n=[];return i&&n.push(...Z({name:t,attributes:i},"attributes")),r&&n.push(...Z({name:t,classes:r},"classes")),o&&n.push(...Z({name:t,styles:o},"styles")),n}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class xt extends g{static get requires(){return[f]}static get pluginName(){return"CodeBlockElementSupport"}static get isOfficialPlugin(){return!0}init(){if(!this.editor.plugins.has("CodeBlockEditing"))return;const t=this.editor.plugins.get(f);t.on("register:pre",(i,r)=>{if(r.model!=="codeBlock")return;const o=this.editor,n=o.model.schema,s=o.conversion;n.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),s.for("upcast").add(Ie(t)),s.for("downcast").add(_e()),i.stop()})}}function Ie(e){return t=>{t.on("element:code",(i,r,o)=>{const n=r.viewItem,s=n.parent;if(!s||!s.is("element","pre"))return;l(s,"htmlPreAttributes"),l(n,"htmlContentAttributes");function l(m,a){const c=e.processViewAttributes(m,o);c&&o.writer.setAttribute(a,c,r.modelRange)}},{priority:"low"})}}function _e(){return e=>{e.on("attribute:htmlPreAttributes:codeBlock",(t,i,r)=>{if(!r.consumable.consume(i.item,t.name))return;const{attributeOldValue:o,attributeNewValue:n}=i,l=r.mapper.toViewElement(i.item).parent;w(r.writer,o,n,l)}),e.on("attribute:htmlContentAttributes:codeBlock",(t,i,r)=>{if(!r.consumable.consume(i.item,t.name))return;const{attributeOldValue:o,attributeNewValue:n}=i,s=r.mapper.toViewElement(i.item);w(r.writer,o,n,s)})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Rt extends g{static get requires(){return[f]}static get pluginName(){return"DualContentModelElementSupport"}static get isOfficialPlugin(){return!0}init(){this.editor.plugins.get(f).on("register",(i,r)=>{const o=r,n=this.editor,s=n.model.schema,l=n.conversion;if(!o.paragraphLikeModel||s.isRegistered(o.model)||s.isRegistered(o.paragraphLikeModel))return;const m={model:o.paragraphLikeModel,view:o.view};s.register(o.model,o.modelSchema),s.register(m.model,{inheritAllFrom:"$block"}),l.for("upcast").elementToElement({view:o.view,model:(a,{writer:c})=>this._hasBlockContent(a)?c.createElement(o.model):c.createElement(m.model),converterPriority:_.low+.5}),l.for("downcast").elementToElement({view:o.view,model:o.model}),this._addAttributeConversion(o),l.for("downcast").elementToElement({view:m.view,model:m.model}),this._addAttributeConversion(m),i.stop()})}_hasBlockContent(t){const i=this.editor.editing.view,r=i.domConverter.blockElements;for(const o of i.createRangeIn(t).getItems())if(o.is("element")&&r.includes(o.name))return!0;return!1}_addAttributeConversion(t){const i=this.editor,r=i.conversion,o=i.plugins.get(f);i.model.schema.extend(t.model,{allowAttributes:b(t.view)}),r.for("upcast").add(S(t,o)),r.for("downcast").add(F(t))}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Ht extends g{static get requires(){return[O,oe]}static get pluginName(){return"HeadingElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("HeadingEditing"))return;const i=t.config.get("heading.options");this.registerHeadingElements(t,i)}registerHeadingElements(t,i){const r=t.plugins.get(O),o=[];for(const n of i)"model"in n&&"view"in n&&(r.registerBlockElement({view:n.view,model:n.model}),o.push(n.model));r.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:o}}),r.extendBlockElement({model:"htmlSummary",modelSchema:{allowChildren:o}})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/function C(e,t,i){const r=e.createRangeOn(t);for(const{item:o}of r.getWalker())if(o.is("element",i))return o}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Mt extends g{static get requires(){return[f]}static get pluginName(){return"ImageElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("ImageInlineEditing")&&!t.plugins.has("ImageBlockEditing"))return;const i=t.model.schema,r=t.conversion,o=t.plugins.get(f);o.on("register:figure",()=>{r.for("upcast").add(De(o))}),o.on("register:img",(n,s)=>{s.model!=="imageBlock"&&s.model!=="imageInline"||(i.isRegistered("imageBlock")&&i.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),i.isRegistered("imageInline")&&i.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),r.for("upcast").add($e(o)),r.for("downcast").add(je()),t.plugins.has("LinkImage")&&r.for("upcast").add(Be(o,t)),n.stop())})}}function $e(e){return t=>{t.on("element:img",(i,r,o)=>{if(!r.modelRange)return;const n=r.viewItem,s=e.processViewAttributes(n,o);s&&o.writer.setAttribute("htmlImgAttributes",s,r.modelRange)},{priority:"low"})}}function Be(e,t){const i=t.plugins.get("ImageUtils");return r=>{r.on("element:a",(o,n,s)=>{const l=n.viewItem;if(!i.findViewImgElement(l))return;const a=n.modelCursor.parent;if(!a.is("element","imageBlock"))return;const c=e.processViewAttributes(l,s);c&&s.writer.setAttribute("htmlLinkAttributes",c,a)},{priority:"low"})}}function De(e){return t=>{t.on("element:figure",(i,r,o)=>{const n=r.viewItem;if(!r.modelRange||!n.hasClass("image"))return;const s=e.processViewAttributes(n,o);s&&o.writer.setAttribute("htmlFigureAttributes",s,r.modelRange)},{priority:"low"})}}function je(){return e=>{t("htmlImgAttributes"),i("img","htmlImgAttributes"),i("figure","htmlFigureAttributes"),i("a","htmlLinkAttributes");function t(r){e.on(`attribute:${r}:imageInline`,(o,n,s)=>{if(!s.consumable.consume(n.item,o.name))return;const{attributeOldValue:l,attributeNewValue:m}=n,a=s.mapper.toViewElement(n.item);w(s.writer,l,m,a)},{priority:"low"})}function i(r,o){e.on(`attribute:${o}:imageBlock`,(n,s,l)=>{if(!l.consumable.test(s.item,n.name))return;const{attributeOldValue:m,attributeNewValue:a}=s,c=l.mapper.toViewElement(s.item),u=C(l.writer,c,r);u&&(w(l.writer,m,a,u),l.consumable.consume(s.item,n.name))},{priority:"low"}),r==="a"&&e.on("attribute:linkHref:imageBlock",(n,s,l)=>{if(!l.consumable.consume(s.item,"attribute:htmlLinkAttributes:imageBlock"))return;const m=l.mapper.toViewElement(s.item),a=C(l.writer,m,"a");y(l.writer,s.item.getAttribute("htmlLinkAttributes"),a)},{priority:"low"})}}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Vt extends g{static get requires(){return[f]}static get pluginName(){return"MediaEmbedElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("MediaEmbed")||t.config.get("mediaEmbed.previewsInData"))return;const i=t.model.schema,r=t.conversion,o=this.editor.plugins.get(f),n=this.editor.plugins.get(O),s=t.config.get("mediaEmbed.elementName");n.registerBlockElement({model:"media",view:s}),o.on("register:figure",()=>{r.for("upcast").add(xe(o))}),o.on(`register:${s}`,(l,m)=>{m.model==="media"&&(i.extend("media",{allowAttributes:[b(s),"htmlFigureAttributes"]}),r.for("upcast").add(Te(o,s)),r.for("dataDowncast").add(Re(s)),l.stop())})}}function Te(e,t){const i=(r,o,n)=>{const s=o.viewItem;l(s,b(t));function l(m,a){const c=e.processViewAttributes(m,n);c&&n.writer.setAttribute(a,c,o.modelRange)}};return r=>{r.on(`element:${t}`,i,{priority:"low"})}}function xe(e){return t=>{t.on("element:figure",(i,r,o)=>{const n=r.viewItem;if(!r.modelRange||!n.hasClass("media"))return;const s=e.processViewAttributes(n,o);s&&o.writer.setAttribute("htmlFigureAttributes",s,r.modelRange)},{priority:"low"})}}function Re(e){return t=>{i(e,b(e)),i("figure","htmlFigureAttributes");function i(r,o){t.on(`attribute:${o}:media`,(n,s,l)=>{if(!l.consumable.consume(s.item,n.name))return;const{attributeOldValue:m,attributeNewValue:a}=s,c=l.mapper.toViewElement(s.item),u=C(l.writer,c,r);w(l.writer,m,a,u)})}}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Nt extends g{static get requires(){return[f]}static get pluginName(){return"ScriptElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.plugins.get(f);t.on("register:script",(i,r)=>{const o=this.editor,n=o.model.schema,s=o.conversion;n.register("htmlScript",r.modelSchema),n.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),o.data.registerRawContentMatcher({name:"script"}),s.for("upcast").elementToElement({view:"script",model:V(r)}),s.for("upcast").add(S(r,t)),s.for("downcast").elementToElement({model:"htmlScript",view:(l,{writer:m})=>D("script",l,m)}),s.for("downcast").add(F(r)),i.stop()})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const He=["width","max-width","min-width","height","min-height","max-height"];class Lt extends g{static get requires(){return[f]}static get pluginName(){return"TableElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("TableEditing"))return;const i=t.model.schema,r=t.conversion,o=t.plugins.get(f),n=t.plugins.get("TableUtils");o.on("register:figure",()=>{r.for("upcast").add(Ne(o))}),o.on("register:table",(s,l)=>{l.model==="table"&&(i.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),r.for("upcast").add(Ve(o)),r.for("downcast").add(Le()),t.model.document.registerPostFixer(Me(t.model,n)),s.stop())})}}function Me(e,t){return i=>{const r=e.document.differ.getChanges();let o=!1;for(const n of r){if(n.type!="attribute"||n.attributeKey!="headingRows")continue;const s=n.range.start.nodeAfter,l=s.getAttribute("htmlTheadAttributes"),m=s.getAttribute("htmlTbodyAttributes");l&&!n.attributeNewValue?(i.removeAttribute("htmlTheadAttributes",s),o=!0):m&&n.attributeNewValue==t.getRows(s)&&(i.removeAttribute("htmlTbodyAttributes",s),o=!0)}return o}}function Ve(e){return t=>{t.on("element:table",(i,r,o)=>{if(!r.modelRange)return;const n=r.viewItem;s(n,"htmlTableAttributes");for(const l of n.getChildren())l.is("element","thead")&&s(l,"htmlTheadAttributes"),l.is("element","tbody")&&s(l,"htmlTbodyAttributes");function s(l,m){const a=e.processViewAttributes(l,o);a&&o.writer.setAttribute(m,a,r.modelRange)}},{priority:"low"})}}function Ne(e){return t=>{t.on("element:figure",(i,r,o)=>{const n=r.viewItem;if(!r.modelRange||!n.hasClass("table"))return;const s=e.processViewAttributes(n,o);s&&o.writer.setAttribute("htmlFigureAttributes",s,r.modelRange)},{priority:"low"})}}function Le(){return e=>{t("table","htmlTableAttributes"),t("figure","htmlFigureAttributes"),t("thead","htmlTheadAttributes"),t("tbody","htmlTbodyAttributes");function t(i,r){e.on(`attribute:${r}:table`,(o,n,s)=>{if(!s.consumable.test(n.item,o.name))return;const l=s.mapper.toViewElement(n.item),m=C(s.writer,l,i);if(m)if(s.consumable.consume(n.item,o.name),r==="htmlTableAttributes"&&l!==m){const a=Ut(n.attributeOldValue),c=Ut(n.attributeNewValue);w(s.writer,a.tableAttributes,c.tableAttributes,m),w(s.writer,a.figureAttributes,c.figureAttributes,l)}else w(s.writer,n.attributeOldValue,n.attributeNewValue,m)})}}}function Ut(e){const t={},i={...e};if(!e||!("styles"in e))return{figureAttributes:t,tableAttributes:i};i.styles={};for(const[r,o]of Object.entries(e.styles))He.includes(r)?t.styles={...t.styles,[r]:o}:i.styles={...i.styles,[r]:o};return{figureAttributes:t,tableAttributes:i}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Wt extends g{static get requires(){return[f]}static get pluginName(){return"StyleElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.plugins.get(f);t.on("register:style",(i,r)=>{const o=this.editor,n=o.model.schema,s=o.conversion;n.register("htmlStyle",r.modelSchema),n.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),o.data.registerRawContentMatcher({name:"style"}),s.for("upcast").elementToElement({view:"style",model:V(r)}),s.for("upcast").add(S(r,t)),s.for("downcast").elementToElement({model:"htmlStyle",view:(l,{writer:m})=>D("style",l,m)}),s.for("downcast").add(F(r)),i.stop()})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class zt extends g{static get requires(){return[f]}static get pluginName(){return"ListElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("ListEditing"))return;const i=t.model.schema,r=t.conversion,o=t.plugins.get(f),n=t.plugins.get("ListEditing"),s=t.plugins.get("ListUtils"),l=["ul","ol","li"];n.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:y}),n.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:y}),n.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:y}),o.on("register",(m,a)=>{if(!l.includes(a.view)||(m.stop(),i.checkAttribute("$block","htmlLiAttributes")))return;const c=l.map(u=>b(u));i.extend("$listItem",{allowAttributes:c}),r.for("upcast").add(u=>{u.on("element:ul",tt("htmlUlAttributes",o),{priority:"low"}),u.on("element:ol",tt("htmlOlAttributes",o),{priority:"low"}),u.on("element:li",tt("htmlLiAttributes",o),{priority:"low"})})}),n.on("postFixer",(m,{listNodes:a,writer:c})=>{for(const{node:u,previousNodeInList:d}of a)if(d){if(d.getAttribute("listType")==u.getAttribute("listType")){const h=qt(d.getAttribute("listType")),p=d.getAttribute(h);!Ft(u.getAttribute(h),p)&&c.model.schema.checkAttribute(u,h)&&(c.setAttribute(h,p,u),m.return=!0)}if(d.getAttribute("listItemId")==u.getAttribute("listItemId")){const h=d.getAttribute("htmlLiAttributes");!Ft(u.getAttribute("htmlLiAttributes"),h)&&c.model.schema.checkAttribute(u,"htmlLiAttributes")&&(c.setAttribute("htmlLiAttributes",h,u),m.return=!0)}}}),n.on("postFixer",(m,{listNodes:a,writer:c})=>{for(const{node:u}of a){const d=u.getAttribute("listType");!s.isNumberedListType(d)&&u.getAttribute("htmlOlAttributes")&&(c.removeAttribute("htmlOlAttributes",u),m.return=!0),s.isNumberedListType(d)&&u.getAttribute("htmlUlAttributes")&&(c.removeAttribute("htmlUlAttributes",u),m.return=!0)}})}afterInit(){const t=this.editor;if(!t.commands.get("indentList"))return;const i=t.commands.get("indentList");this.listenTo(i,"afterExecute",(r,o)=>{t.model.change(n=>{for(const s of o){const l=qt(s.getAttribute("listType"));t.model.schema.checkAttribute(s,l)&&n.setAttribute(l,{},s)}})})}}function tt(e,t){return(i,r,o)=>{const n=r.viewItem;r.modelRange||Object.assign(r,o.convertChildren(r.viewItem,r.modelCursor));const s=t.processViewAttributes(n,o);for(const l of r.modelRange.getItems({shallow:!0}))l.hasAttribute("listItemId")&&(l.hasAttribute("htmlUlAttributes")||l.hasAttribute("htmlOlAttributes")||o.writer.model.schema.checkAttribute(l,e)&&o.writer.setAttribute(e,s||{},l))}}function qt(e){return e==="numbered"||e=="customNumbered"?"htmlOlAttributes":"htmlUlAttributes"}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Gt extends g{static get requires(){return[f]}static get pluginName(){return"HorizontalLineElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor;if(!t.plugins.has("HorizontalLineEditing"))return;const i=t.model.schema,r=t.conversion,o=t.plugins.get(f);o.on("register:hr",(n,s)=>{s.model==="horizontalLine"&&(i.extend("horizontalLine",{allowAttributes:["htmlHrAttributes"]}),r.for("upcast").add(S(s,o)),r.for("downcast").add(Ue()),n.stop())})}}function Ue(){return e=>{e.on("attribute:htmlHrAttributes:horizontalLine",(t,i,r)=>{if(!r.consumable.test(i.item,t.name))return;const{attributeOldValue:o,attributeNewValue:n}=i,s=r.mapper.toViewElement(i.item),l=C(r.writer,s,"hr");l&&(w(r.writer,o,n,l),r.consumable.consume(i.item,t.name))},{priority:"low"})}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Kt extends g{static get requires(){return[f,O]}static get pluginName(){return"CustomElementSupport"}static get isOfficialPlugin(){return!0}init(){const t=this.editor.plugins.get(f),i=this.editor.plugins.get(O);t.on("register:$customElement",(r,o)=>{r.stop();const n=this.editor,s=n.model.schema,l=n.conversion,m=n.editing.view.domConverter.unsafeElements,a=n.data.htmlProcessor.domConverter.preElements;s.register(o.model,o.modelSchema),s.extend(o.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),n.data.htmlProcessor.domConverter.registerRawContentMatcher({name:"template"}),l.for("upcast").elementToElement({view:/.*/,model:(c,u)=>{if(c.name=="$comment"||!We(c.name)||i.getDefinitionsForView(c.name).size)return null;m.includes(c.name)||m.push(c.name),a.includes(c.name)||a.push(c.name);const d=u.writer.createElement(o.model,{htmlElementName:c.name}),h=t.processViewAttributes(c,u);h&&u.writer.setAttribute("htmlCustomElementAttributes",h,d);let p;if(c.is("element","template")&&c.getCustomProperty("$rawContent"))p=c.getCustomProperty("$rawContent");else{const N=new W(c.document).createDocumentFragment(c),L=n.data.htmlProcessor.domConverter.viewToDom(N),U=L.firstChild;for(;U.firstChild;)L.appendChild(U.firstChild);U.remove(),p=n.data.htmlProcessor.htmlWriter.getHtml(L)}u.writer.setAttribute("htmlContent",p,d);for(const{item:j}of n.editing.view.createRangeIn(c))u.consumable.consume(j,{name:!0});return d},converterPriority:"low"}),l.for("editingDowncast").elementToElement({model:{name:o.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(c,{writer:u})=>{const d=c.getAttribute("htmlElementName"),h=u.createRawElement(d);return c.hasAttribute("htmlCustomElementAttributes")&&y(u,c.getAttribute("htmlCustomElementAttributes"),h),h}}),l.for("dataDowncast").elementToElement({model:{name:o.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(c,{writer:u})=>{const d=c.getAttribute("htmlElementName"),h=c.getAttribute("htmlContent"),p=u.createRawElement(d,null,(j,N)=>{N.setContentOf(j,h)});return c.hasAttribute("htmlCustomElementAttributes")&&y(u,c.getAttribute("htmlCustomElementAttributes"),p),p}})})}}function We(e){try{document.createElement(e)}catch{return!1}return!0}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class ze extends g{static get pluginName(){return"GeneralHtmlSupport"}static get isOfficialPlugin(){return!0}static get requires(){return[f,xt,Rt,Ht,Mt,Vt,Nt,Lt,Wt,zt,Gt,Kt]}init(){const t=this.editor,i=t.plugins.get(f);i.loadAllowedEmptyElementsConfig(t.config.get("htmlSupport.allowEmpty")||[]),i.loadAllowedConfig(t.config.get("htmlSupport.allow")||[]),i.loadDisallowedConfig(t.config.get("htmlSupport.disallow")||[])}afterInit(){this.editor.commands.get("removeFormat")?.registerCustomAttribute(i=>i.startsWith("html")&&i.endsWith("Attributes"),Se)}getGhsAttributeNameForElement(t){const i=this.editor.plugins.get("DataSchema"),r=Array.from(i.getDefinitionsForView(t,!1)),o=r.find(n=>n.isInline&&!r[0].isObject);return o?o.model:b(t)}addModelHtmlClass(t,i,r){const o=this.editor.model,n=this.getGhsAttributeNameForElement(t);o.change(s=>{for(const l of P(o,r,n))E(s,l,n,"classes",m=>{for(const a of I(i))m.add(a)})})}removeModelHtmlClass(t,i,r){const o=this.editor.model,n=this.getGhsAttributeNameForElement(t);o.change(s=>{for(const l of P(o,r,n))E(s,l,n,"classes",m=>{for(const a of I(i))m.delete(a)})})}setModelHtmlAttributes(t,i,r){const o=this.editor.model,n=this.getGhsAttributeNameForElement(t);o.change(s=>{for(const l of P(o,r,n))E(s,l,n,"attributes",m=>{for(const[a,c]of Object.entries(i))m.set(a,c)})})}removeModelHtmlAttributes(t,i,r){const o=this.editor.model,n=this.getGhsAttributeNameForElement(t);o.change(s=>{for(const l of P(o,r,n))E(s,l,n,"attributes",m=>{for(const a of I(i))m.delete(a)})})}setModelHtmlStyles(t,i,r){const o=this.editor.model,n=this.getGhsAttributeNameForElement(t);o.change(s=>{for(const l of P(o,r,n))E(s,l,n,"styles",m=>{for(const[a,c]of Object.entries(i))m.set(a,c)})})}removeModelHtmlStyles(t,i,r){const o=this.editor.model,n=this.getGhsAttributeNameForElement(t);o.change(s=>{for(const l of P(o,r,n))E(s,l,n,"styles",m=>{for(const a of I(i))m.delete(a)})})}}function*P(e,t,i){if(t)if(!(Symbol.iterator in t)&&t.is("documentSelection")&&t.isCollapsed)e.schema.checkAttributeInSelection(t,i)&&(yield t);else for(const r of qe(e,t,i))yield*r.getItems({shallow:!0})}function qe(e,t,i){return!(Symbol.iterator in t)&&(t.is("node")||t.is("$text")||t.is("$textProxy"))?e.schema.checkAttribute(t,i)?[e.createRangeOn(t)]:[]:e.schema.getValidRanges(e.createSelection(t).getRanges(),i)}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Ge extends g{static get pluginName(){return"HtmlComment"}static get isOfficialPlugin(){return!0}init(){const t=this.editor,i=new Map;t.data.processor.skipComments=!1,t.model.schema.addAttributeCheck((r,o)=>{if(r.endsWith("$root")&&o.startsWith("$comment"))return!0}),t.conversion.for("upcast").elementToMarker({view:"$comment",model:r=>{const n=`$comment:${et()}`,s=r.getCustomProperty("$rawContent");return i.set(n,s),n}}),t.conversion.for("dataDowncast").markerToElement({model:"$comment",view:(r,{writer:o})=>{let n;for(const a of this.editor.model.document.getRootNames())if(n=this.editor.model.document.getRoot(a),n.hasAttribute(r.markerName))break;const s=r.markerName,l=n.getAttribute(s),m=o.createUIElement("$comment");return o.setCustomProperty("$rawContent",l,m),m}}),t.model.document.registerPostFixer(r=>{let o=!1;const n=t.model.document.differ.getChangedMarkers().filter(s=>s.name.startsWith("$comment:"));for(const s of n){const{oldRange:l,newRange:m}=s.data;if(!(l&&m&&l.root==m.root)){if(l){const a=l.root;a.hasAttribute(s.name)&&(r.removeAttribute(s.name,a),o=!0)}if(m){const a=m.root;a.rootName=="$graveyard"?(r.removeMarker(s.name),o=!0):a.hasAttribute(s.name)||(r.setAttribute(s.name,i.get(s.name)||"",a),o=!0)}}}return o}),t.data.on("set",()=>{for(const r of t.model.markers.getMarkersGroup("$comment"))this.removeHtmlComment(r.name)},{priority:"high"}),t.model.on("deleteContent",(r,[o])=>{for(const n of o.getRanges()){const s=t.model.schema.getLimitElement(n),l=t.model.createPositionAt(s,0),m=t.model.createPositionAt(s,"end");let a;l.isTouching(n.start)&&m.isTouching(n.end)?a=this.getHtmlCommentsInRange(t.model.createRange(l,m)):a=this.getHtmlCommentsInRange(n,{skipBoundaries:!0});for(const c of a)this.removeHtmlComment(c)}},{priority:"high"})}createHtmlComment(t,i){const r=et(),n=this.editor.model,s=n.document.getRoot(t.root.rootName),l=`$comment:${r}`;return n.change(m=>{const a=m.createRange(t);return m.addMarker(l,{usingOperation:!0,affectsData:!0,range:a}),m.setAttribute(l,i,s),l})}removeHtmlComment(t){const i=this.editor,r=i.model.markers.get(t);return r?(i.model.change(o=>{o.removeMarker(r)}),!0):!1}getHtmlCommentData(t){const r=this.editor.model.markers.get(t);if(!r)return null;let o="";for(const n of this.editor.model.document.getRoots())if(n.hasAttribute(t)){o=n.getAttribute(t);break}return{content:o,position:r.getStart()}}getHtmlCommentsInRange(t,{skipBoundaries:i=!1}={}){const r=!i;return Array.from(this.editor.model.markers.getMarkersGroup("$comment")).filter(n=>o(n,t)).map(n=>n.name);function o(n,s){const l=n.getRange().start;return(l.isAfter(s.start)||r&&l.isEqual(s.start))&&(l.isBefore(s.end)||r&&l.isEqual(s.end))}}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Xt extends re{toView(t){if(!/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(t.trim().slice(0,1e4)))return super.toView(t);let i="",r="";t=t.trim().replace(/<\?xml\s[^?]*\?>/i,m=>(r=m,"")),t=t.trim().replace(/^<!DOCTYPE\s[^>]*?>/i,m=>(i=m,""));const o=this._toDom(t),n=this.domConverter.domToView(o,{skipComments:this.skipComments}),s=new W(n.document);s.setCustomProperty("$fullPageDocument",o.ownerDocument.documentElement.outerHTML,n);const l=Array.from(o.ownerDocument.querySelectorAll("head style"));return s.setCustomProperty("$fullPageHeadStyles",l,n),i&&s.setCustomProperty("$fullPageDocType",i,n),r&&s.setCustomProperty("$fullPageXmlDeclaration",r,n),n}toData(t){let i=super.toData(t);const r=t.getCustomProperty("$fullPageDocument"),o=t.getCustomProperty("$fullPageDocType"),n=t.getCustomProperty("$fullPageXmlDeclaration");return r&&(i=r.replace(/<\/body\s*>/,i+"$&"),o&&(i=o+`
`+i),n&&(i=n+`
`+i)),i}}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/class Ke extends g{static get pluginName(){return"FullPage"}static get isOfficialPlugin(){return!0}constructor(t){super(t),t.config.define("htmlSupport.fullPage",{allowRenderStylesFromHead:!1,sanitizeCss:i=>(te("css-full-page-provide-sanitize-function"),{css:i,hasChanged:!1})}),t.data.processor=new Xt(t.data.viewDocument)}init(){const t=this.editor,i=["$fullPageDocument","$fullPageDocType","$fullPageXmlDeclaration","$fullPageHeadStyles"];t.model.schema.extend("$root",{allowAttributes:i}),t.data.on("toModel",(r,[o])=>{const n=t.model.document.getRoot();t.model.change(s=>{for(const l of i){const m=o.getCustomProperty(l);m&&s.setAttribute(l,m,n)}}),Yt(t)&&this._renderStylesFromHead(n)},{priority:"low"}),t.data.on("toView",(r,[o])=>{if(!o.is("rootElement"))return;const n=o,s=r.return;if(!n.hasAttribute("$fullPageDocument"))return;const l=new W(s.document);for(const m of i){const a=n.getAttribute(m);a&&l.setCustomProperty(m,a,s)}},{priority:"low"}),t.data.on("set",()=>{const r=t.model.document.getRoot();t.model.change(o=>{for(const n of i)r.hasAttribute(n)&&o.removeAttribute(n,r)})},{priority:"high"}),t.data.on("get",(r,o)=>{o[0]||(o[0]={}),o[0].trim=!1},{priority:"high"})}destroy(){super.destroy(),Yt(this.editor)&&this._removeStyleElementsFromDom()}_removeStyleElementsFromDom(){const t=Array.from(rt.document.querySelectorAll(`[data-full-page-style-id="${this.editor.id}"]`));for(const i of t)i.remove()}_renderStyleElementsInDom(t){const i=this.editor,r=t.getAttribute("$fullPageHeadStyles");if(!r)return;const o=i.config.get("htmlSupport.fullPage.sanitizeCss");for(const n of r){n.setAttribute("data-full-page-style-id",i.id);const s=o(n.innerText);s.hasChanged&&(n.innerText=s.css),rt.document.head.append(n)}}_renderStylesFromHead(t){this._removeStyleElementsFromDom(),this._renderStyleElementsInDom(t)}}function Yt(e){return e.config.get("htmlSupport.fullPage.allowRenderStylesFromHead")}/**
* @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
*/const A="htmlEmptyBlock";class Xe extends g{static get pluginName(){return"EmptyBlock"}static get isOfficialPlugin(){return!0}afterInit(){const{model:t,conversion:i,plugins:r,config:o}=this.editor,n=t.schema,s=o.get("htmlSupport.preserveEmptyBlocksInEditingView");n.extend("$block",{allowAttributes:[A]}),n.extend("$container",{allowAttributes:[A]}),n.isRegistered("tableCell")&&n.extend("tableCell",{allowAttributes:[A]}),s?i.for("downcast").add(Qt()):i.for("dataDowncast").add(Qt()),i.for("upcast").add(Ye(n)),r.has("ClipboardPipeline")&&this._registerClipboardPastingHandler()}_registerClipboardPastingHandler(){const t=this.editor.plugins.get("ClipboardPipeline");this.listenTo(t,"contentInsertion",(i,r)=>{r.sourceEditorId!==this.editor.id&&this.editor.model.change(o=>{for(const{item:n}of o.createRangeIn(r.content))n.is("element")&&n.hasAttribute(A)&&o.removeAttribute(A,n)})})}}function Qt(){return e=>{e.on(`attribute:${A}`,(t,i,r)=>{const{mapper:o,consumable:n}=r,{item:s}=i;if(!n.consume(s,t.name))return;const l=o.toViewElement(s);l&&i.attributeNewValue&&(l.getFillerOffset=()=>null)})}}function Ye(e){return t=>{t.on("element",(i,r,o)=>{const{viewItem:n,modelRange:s}=r;if(!n.is("element")||!n.isEmpty||n.getCustomProperty("$hasBlockFiller"))return;const l=s&&s.start.nodeAfter;if(!l||!e.checkAttribute(l,A)||(o.writer.setAttribute(A,!0,l),l.childCount!=1))return;const m=l.getChild(0);m.is("element","paragraph")&&e.checkAttribute(m,A)&&o.writer.setAttribute(A,!0,m)},{priority:"lowest"})}}export{xt as CodeBlockElementSupport,Kt as CustomElementSupport,f as DataFilter,O as DataSchema,Rt as DualContentModelElementSupport,Xe as EmptyBlock,Ke as FullPage,ze as GeneralHtmlSupport,Ht as HeadingElementSupport,Gt as HorizontalLineElementSupport,Ge as HtmlComment,Xt as HtmlPageDataProcessor,Mt as ImageElementSupport,zt as ListElementSupport,Vt as MediaEmbedElementSupport,Nt as ScriptElementSupport,Wt as StyleElementSupport,Lt as TableElementSupport,J as _HTML_SUPPORT_SCHEMA_DEFINITIONS,Dt as _attributeToInlineHtmlSupportConverter,D as _createObjectHtmlSupportView,Q as _emptyInlineModelElementToViewHtmlSupportConverter,b as _getHtmlSupportAttributeName,C as _getHtmlSupportDescendantElement,It as _mergeHtmlSupportViewElementAttributes,F as _modelToViewBlockAttributeHtmlSupportConverter,E as _modifyHtmlSupportGhsAttribute,Pt as _removeHtmlSupportViewAttributes,y as _setHtmlSupportViewAttributes,_t as _toHtmlSupportPascalCase,$t as _toObjectWidgetHtmlSupportConverter,w as _updateHtmlSupportViewAttributes,Bt as _viewToAttributeInlineHtmlSupportConverter,S as _viewToModelBlockAttributeHtmlSupportConverter,V as _viewToModelObjectContentHtmlSupportConverter};
