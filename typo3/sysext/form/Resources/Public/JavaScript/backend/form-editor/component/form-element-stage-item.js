/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
import{LitElement as f,html as o,nothing as c}from"lit";import{property as r,customElement as v}from"lit/decorators.js";import a from"~labels/form.form_editor_javascript";import"@typo3/backend/element/icon-element.js";var i=function(d,e,n,l){var m=arguments.length,s=m<3?e:l===null?l=Object.getOwnPropertyDescriptor(e,n):l,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(d,e,n,l);else for(var u=d.length-1;u>=0;u--)(p=d[u])&&(s=(m<3?p(s):m>3?p(e,n,s):p(e,n))||s);return m>3&&s&&Object.defineProperty(e,n,s),s};let t=class extends f{constructor(){super(...arguments),this.elementType="",this.elementIdentifier="",this.elementLabel="",this.elementIconIdentifier="",this.isRequired=!1,this.isHidden=!1,this.validators=[],this.options=[]}createRenderRoot(){return this}render(){return o`${this.renderToolbar()}<div class=formeditor-element-label><span>${this.elementType}</span>: <span>${this.elementIdentifier}</span></div><div class=formeditor-element-body><div class=formeditor-element-icon><typo3-backend-icon identifier=${this.elementIconIdentifier} size=small overlay=${this.isHidden?"overlay-hidden":""}></typo3-backend-icon></div><div class=formeditor-element-info><div class=formeditor-element-info-label><span>${this.elementLabel}</span> ${this.isRequired?o`<span>*</span>`:c}</div>${this.renderInfoContent()}</div>${this.renderValidators()}</div>`}renderInfoContent(){const e=this.renderContentItems();return e.length?o`<div class=formeditor-element-info-content>${e}</div>`:c}renderToolbar(){return this.toolbarConfig?.showToolbar?o`<div class=formeditor-element-toolbar><div class=btn-toolbar>${this.renderToolbarNewElementButton()}<div class="btn-group btn-group-sm" role=group><a class="btn btn-default" href=# title=${a.get("formEditor.stage.toolbar.remove")} @click=${this.handleRemoveElement}> <typo3-backend-icon identifier=actions-edit-delete size=small></typo3-backend-icon> </a></div></div></div>`:c}renderToolbarNewElementButton(){return this.toolbarConfig?.isCompositeElement?o`<div class="btn-group btn-group-sm" role=group><div class=btn-group><button type=button class="btn btn-sm btn-default dropdown-toggle" popovertarget=toggle-menu-new-form-element aria-expanded=false title=${a.get("formEditor.stage.toolbar.new_element")}><typo3-backend-icon identifier=actions-document-new size=small></typo3-backend-icon><span class=visually-hidden>Toggle Dropdown</span></button><ul id=toggle-menu-new-form-element class="dropdown-menu dropdown-menu-right" popover><li data-no-sorting><a href=# class=dropdown-item @click=${this.handleNewElementInside}> <span class=dropdown-item-columns><span class="dropdown-item-column dropdown-item-column-icon"> <typo3-backend-icon identifier=actions-form-insert-in size=small></typo3-backend-icon> </span> <span class="dropdown-item-column dropdown-item-column-text">${a.get("formEditor.stage.toolbar.new_element.inside")} </span> </span> </a></li><li data-no-sorting><a href=# class=dropdown-item @click=${this.handleNewElementAfter}> <span class=dropdown-item-columns><span class="dropdown-item-column dropdown-item-column-icon"> <typo3-backend-icon identifier=actions-form-insert-after size=small></typo3-backend-icon> </span> <span class="dropdown-item-column dropdown-item-column-text">${a.get("formEditor.stage.toolbar.new_element.after")} </span> </span> </a></li></ul></div></div>`:o`<div class="btn-group btn-group-sm" role=group><a class="btn btn-default" href=# title=${a.get("formEditor.stage.toolbar.new_element.after")} @click=${this.handleNewElementAfter}> <typo3-backend-icon identifier=actions-document-new size=small></typo3-backend-icon> </a></div>`}handleNewElementAfter(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("toolbar-new-element-after",{bubbles:!0,composed:!0,detail:{elementIdentifier:this.elementIdentifier}}))}handleNewElementInside(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("toolbar-new-element-inside",{bubbles:!0,composed:!0,detail:{elementIdentifier:this.elementIdentifier}}))}handleRemoveElement(e){e.preventDefault(),this.dispatchEvent(new CustomEvent("toolbar-remove-element",{bubbles:!0,composed:!0,detail:{elementIdentifier:this.elementIdentifier}}))}renderContentItems(){const e=[];if(this.content&&e.push(o`<div class=formeditor-element-info-text>${this.content}</div>`),this.options?.length){const n=this.options.map(l=>({label:l.label,className:l.selected?"selected":void 0}));e.push(this.renderMultivalue(n))}if(this.allowedMimeTypes?.length){const n=this.allowedMimeTypes.map(l=>({label:l}));e.push(this.renderMultivalue(n))}return e}renderMultivalue(e){return o`<div class=formeditor-element-info-multivalue>${e.map(n=>o`<div class=formeditor-element-info-multivalue-item${n.className?` ${n.className}`:""}>${n.label}</div>`)}</div>`}renderValidators(){return this.validators?.length?o`<div class=formeditor-element-validator><div class=formeditor-element-validator-icon><typo3-backend-icon identifier=form-validator size=small></typo3-backend-icon></div><div class=formeditor-element-validator-list>${this.validators.map(e=>o`<div class=formeditor-element-validator-list-item>${e.label}</div>`)}</div></div>`:c}};i([r({type:String,attribute:"element-type"})],t.prototype,"elementType",void 0),i([r({type:String,attribute:"element-identifier"})],t.prototype,"elementIdentifier",void 0),i([r({type:String,attribute:"element-label"})],t.prototype,"elementLabel",void 0),i([r({type:String,attribute:"element-icon-identifier"})],t.prototype,"elementIconIdentifier",void 0),i([r({type:Boolean,attribute:"is-required"})],t.prototype,"isRequired",void 0),i([r({type:Boolean,attribute:"is-hidden"})],t.prototype,"isHidden",void 0),i([r({type:Array})],t.prototype,"validators",void 0),i([r({type:Array})],t.prototype,"options",void 0),i([r({type:Array})],t.prototype,"allowedMimeTypes",void 0),i([r({type:String})],t.prototype,"content",void 0),i([r({type:Object})],t.prototype,"toolbarConfig",void 0),t=i([v("typo3-form-form-element-stage-item")],t);export{t as FormElementStageItem};
