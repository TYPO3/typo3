//
// Scaffold
// ========
//
* {
    scrollbar-color: color-mix(in srgb, currentColor, transparent 75%) transparent;
}

:root,
body {
    color: var(--typo3-scaffold-color);
    background-color: var(--typo3-scaffold-bg);
}

body {
    min-height: 100%;
    font-size: var(--typo3-font-size);
}

iframe {
    color: var(--typo3-scaffold-color);
    background-color: var(--typo3-scaffold-bg);
}

//
// Component
//
.scaffold {
    display: grid;
    background-color: var(--typo3-scaffold-bg);
    color: var(--typo3-scaffold-color);
    position: relative;
    height: 100dvh;
    width: 100%;
    contain: strict;
    grid-template-rows: auto 1fr;
    grid-template-columns: clamp(0%, var(--typo3-scaffold-sidebar-expanded-width), 75%) 1fr;
}

.scaffold-header {
    grid-column: 1 / 3;
}

//
// Sidebar
//
.scaffold-sidebar {
    display: none;
    background-color: var(--typo3-scaffold-sidebar-bg);
    color: var(--typo3-scaffold-sidebar-color);
    z-index: calc(var(--typo3-scaffold-header-zindex) - 1);
    overflow: hidden;
    border-inline-end: var(--typo3-scaffold-sidebar-border-width) solid var(--typo3-scaffold-sidebar-boder-color);
    grid-column: 1 / 3;
    grid-row: 2;
    transform: translateX(-100%);
    transition:
        transform .25s ease-in-out,
        display .25s ease-in-out allow-discrete;

    @container (min-width: 320px) {
        grid-column: 1 / 2;
    }
}

.scaffold-content {
    grid-column: 1 / 3;
    grid-row: 2;
}

//
// Small screens: flyout mode (overlay)
//
.scaffold-sidebar-flyout {
    .scaffold-sidebar {
        display: block;
        transform: translateX(0);
        box-shadow: var(--typo3-scaffold-sidebar-box-shadow);

        @starting-style {
            transform: translateX(-100%);
        }
    }
}

//
// Large screens: sidebar always visible, expanded class controls grid layout
//
@container (min-width: 992px) {
    .scaffold {
        grid-template-columns: var(--typo3-scaffold-sidebar-width) 1fr;
    }

    .scaffold-sidebar-expanded {
        --typo3-scaffold-sidebar-width: var(--typo3-scaffold-sidebar-expanded-width);
    }

    .scaffold-sidebar {
        display: flex;
        flex-direction: column;
        grid-column: 1 / 2;
        transform: none;
        transition: none;

        &.scaffold-sidebar-disabled {
            display: none;

            & + .scaffold-content {
                grid-column: 1 / 3;

                &:before {
                    display: none;
                }
            }
        }
    }

    .scaffold-content {
        grid-column: 2 / 3;
    }
}

.scaffold-header {
    display: flex;
    align-items: center;
    gap: var(--typo3-scaffold-gap);
    padding: var(--typo3-scaffold-header-padding-y) var(--typo3-scaffold-header-padding-x);
    height: var(--typo3-scaffold-header-height);
    color: var(--typo3-scaffold-header-color);
    background-color: var(--typo3-scaffold-header-bg);
    box-shadow: var(--typo3-scaffold-header-box-shadow);
    z-index: var(--typo3-scaffold-header-zindex);
}

//
// Topbar
//
.scaffold-topbar {
    display: flex;
    align-items: center;
    flex-grow: 1;
}

//
// Toolbar
//
.scaffold-toolbar {
    z-index: var(--typo3-zindex-dropdown);
    display: none;

    @include media-breakpoint-up('lg') {
        overflow: visible;
        background-color: transparent;
        inset-inline-start: auto;
        bottom: auto;
        display: block;
    }
}

.scaffold-toolbar-expanded {
    .scaffold-toolbar {
        @include media-breakpoint-down('lg') {
            &:before {
                content: "";
                height: 1px;
                position: fixed;
                top: calc(var(--typo3-scaffold-header-height) - 1px);
                inset-inline: 0;
                box-shadow: var(--typo3-scaffold-header-box-shadow);
            }
            position: absolute;
            top: var(--typo3-scaffold-header-height);
            inset-inline: 0;
            height: calc(100dvh - var(--typo3-scaffold-header-height));
            padding: 1rem .5rem;
            display: block;
            overflow: auto;
            background-color: var(--typo3-scaffold-header-foldout-bg);
        }
    }
}

//
// Content
//
.scaffold-content {
    position: relative !important;
    background: var(--typo3-scaffold-bg);
    overflow: auto;
}

.scaffold-content-module {
    height: 100%;
}

.scaffold-content-module-iframe {
    display: block;
    border: none;
    height: 100%;
    width: 100%;
}

.scaffold-content typo3-backend-content-navigation {
    [slot="navigation"] {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    [slot="content"] {
        flex: 1 0 0;
        height: 100%;
        display: flex;
        flex-direction: row;
    }
}

//
// Overlay
//
.scaffold-overlay {
    display: none;
    grid-column: 1 / 3;
    grid-row: 2;
    z-index: calc(var(--typo3-scaffold-header-zindex) - 2);
    opacity: 0;
    background-color: var(--typo3-overlay-bg);
    transition:
        opacity .25s ease-in-out,
        display .25s ease-in-out allow-discrete;

    .scaffold-sidebar-flyout & {
        display: block;
        opacity: var(--typo3-overlay-opacity);

        @starting-style {
            opacity: 0;
        }
    }
}
